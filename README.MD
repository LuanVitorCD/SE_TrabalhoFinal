# ğŸŒ¦ï¸ EcoSense IoT -- EstaÃ§Ã£o MeteorolÃ³gica Inteligente

[![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://www.python.org/)
[![Framework](https://img.shields.io/badge/Framework-Streamlit-red.svg)](https://streamlit.io/)
[![Hardware](https://img.shields.io/badge/Hardware-ESP32-green.svg)]()
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

Um sistema completo de monitoramento ambiental voltado para eficiÃªncia, baixo custo e controle remoto. A soluÃ§Ã£o integra **ESP32 + MQTT + Firebase + Streamlit**, oferecendo coleta contÃ­nua de dados climÃ¡ticos, visualizaÃ§Ã£o em tempo real e configuraÃ§Ã£o remota de limites.

<p align="center">
  <img src="assets/dashboard_print.png" width="700" title="Interface do Dashboard">
</p>

------------------------------------------------------------------------

## ğŸŒ VisÃ£o Geral do Projeto

O **EcoSense IoT** monitora temperatura e umidade usando um sensor DHT22 conectado ao ESP32. Os dados sÃ£o enviados via **MQTT** para um script **Python Bridge**, que os salva no **Firestore**, permitindo consultÃ¡-los no **Dashboard Web**.

O sistema tambÃ©m permite **controle remoto**: o usuÃ¡rio define limites no Dashboard e o ESP32 recebe automaticamente as novas configuraÃ§Ãµes via MQTT.

------------------------------------------------------------------------

## ğŸ—ï¸ Arquitetura do Sistema

O fluxo do projeto combina comunicaÃ§Ã£o bidirecional utilizando **MQTT + Firebase**.

### **1. Monitoramento (Upload)**

-   ESP32 lÃª o DHT22 a cada 15 segundos;
-   Publica temperatura e umidade via MQTT;
-   O *Bridge* Python intercepta e grava os dados no Firestore;
-   O Dashboard exibe dados utilizando cache para economia.

### **2. Controle Remoto (Download)**

-   UsuÃ¡rio define limites no Dashboard;
-   Dashboard salva a configuraÃ§Ã£o no Firestore;
-   O Bridge detecta alteraÃ§Ãµes e publica configuraÃ§Ã£o via MQTT;
-   O ESP32 aplica imediatamente as novas regras (LEDs, limites, etc.).

------------------------------------------------------------------------

## ğŸ›¡ï¸ EstratÃ©gia "Firebase Free Tier" (Economia)

Para manter o projeto dentro do plano gratuito (Spark), foram adotadas otimizaÃ§Ãµes importantes:

-   **Hardware:** envio de dados a cada 15s (reduz \~17k â†’ \~5.7k escritas/dia)
-   **Dashboard:**
    -   KPIs atualizam automaticamente, mas apenas 2 documentos sÃ£o lidos;
    -   GrÃ¡ficos histÃ³ricos sÃ³ atualizam *sob demanda* para evitar exceder o limite diÃ¡rio;
    -   BotÃ£o **"Ativar AtualizaÃ§Ã£o"** permite pausar consumo.

------------------------------------------------------------------------

## ğŸ”Œ Hardware Utilizado

<p align="center">
  <img src="assets/esp32_montado.png" width="700" title="Circuito do ESP32 montado">
</p>

### **ESP32 TTGO T-Beam V1.1**

| Componente       | Pino      | FunÃ§Ã£o                    | Comportamento               |
| ---------------- | --------- | ------------------------- | --------------------------- |
| DHT22            | GPIO 02   | Temperatura/Umidade       | Leitura periÃ³dica           |
| LED Vermelho     | GPIO 25   | Alerta Temperatura        | Pisca se fora do limite     |
| LED Azul         | GPIO 26   | Alerta Umidade            | Pisca se fora do limite     |
| LED Verde        | GPIO 27   | Status                    | Aceso = OK / Apagado = Erro |
| BotÃ£o            | GPIO 38   | Input                     | Alterna telas               |
| Display OLED     | I2C 21/22 | VisualizaÃ§Ã£o              | Mostra dados e IP           |

------------------------------------------------------------------------

## ğŸ’» Componentes de Software

### **1. Firmware -- `ESP32_Sensor_WiFi.ino`**

-   C++ para microcontrolador;
-   Bibliotecas: WiFi, PubSubClient (MQTT), ArduinoJson, Adafruit, SSD1306, DHT.
-   Destaques:
    -   Multitarefa usando `millis()` (sem travar Wi-Fi);
    -   Display OLED exibe limites atuais e status.

------------------------------------------------------------------------

### **2. Ponte de ComunicaÃ§Ã£o -- `backend_bridge.py`**

-   Conecta MQTT â†” Firestore.
-   FunÃ§Ãµes:
    -   Salvar dados recebidos do ESP32;
    -   Detectar alteraÃ§Ãµes no Firestore e enviar comandos.
-   Usa variÃ¡veis de ambiente (.env) para seguranÃ§a.

------------------------------------------------------------------------

### **3. Dashboard Web -- `main.py`**

-   ConstruÃ­do em Streamlit.
-   Funcionalidades:
    -   KPIs com delta;
    -   GrÃ¡ficos histÃ³ricos (manual refresh);
    -   ConfiguraÃ§Ã£o de limites (Temperatura/Umidade);
    -   ExportaÃ§Ã£o CSV.

------------------------------------------------------------------------

## ğŸš€ Como Executar

### **PrÃ©-requisitos**

-   Conta Firebase + Firestore criado;
-   Arquivo `firebase_key.json` na raiz;
-   Broker MQTT ativo (ex.: HiveMQ).

------------------------------------------------------------------------

### **1. Criar arquivo `.env`**
```bash
    FIREBASE_CREDENTIALS=firebase_key.json
    MQTT_BROKER=broker.hivemq.com
    MQTT_PORT=1883
    MQTT_TOPIC_TEMP=esp32/streamlit/temperatura
    MQTT_TOPIC_HUM=esp32/streamlit/umidade
    MQTT_TOPIC_CONFIG=esp32/streamlit/config
    COLLECTION_DATA=estacao_dados
    COLLECTION_CONFIG=estacao_config
    DOC_CONFIG_ID=limites_alerta
```
------------------------------------------------------------------------

### **2. Instalar dependÃªncias**

    pip install streamlit pandas plotly firebase-admin paho-mqtt python-dotenv streamlit-autorefresh

Ou usando:
```bash
    pip install -r requirements.txt
```
------------------------------------------------------------------------

### **3. Rodar o Backend (Bridge)**
```bash
    python backend_bridge.py
```
------------------------------------------------------------------------

### **4. Rodar o Dashboard**
```bash
    streamlit run main.py
```
------------------------------------------------------------------------

### **5. Subir Firmware no ESP32**

1.  Abrir o `ESP32_Sensor_WiFi.ino` na Arduino IDE;
2.  Instalar dependÃªncias;
3.  Inserir `ssid` e `password`;
4.  Fazer upload.

------------------------------------------------------------------------

## ğŸ“š Estrutura de Pastas

    /
    â”œâ”€â”€ .streamlit/
    â”‚   â””â”€â”€ config.toml
    â”‚
    â”œâ”€â”€ data/
    â”‚   â”œâ”€â”€ humidity.csv
    â”‚   â””â”€â”€ temp.csv
    â”‚
    â”œâ”€â”€ ESP32_Sensor_WiFi/
    â”‚   â””â”€â”€ ESP32_Sensor_WiFi.ino
    â”‚
    â”œâ”€â”€ utils/
    â”‚   â”œâ”€â”€ csv_to_firestore.py     // Script para carregar CSVs ao firebase (dados iniciais)
    â”‚   â””â”€â”€ generate_mockdata.py    // Script para gerar dados mockados para pular necessidade de arduino para visualizaÃ§Ã£o da aplicaÃ§Ã£o
    â”‚
    â”œâ”€â”€ backend_bridge.py
    â”œâ”€â”€ main.py
    â”œâ”€â”€ requirements.txt
    â”œâ”€â”€ firebase_key.json      // NÃ£o versionar
    â”œâ”€â”€ .env                   // NÃ£o versionar
    â”œâ”€â”€ .gitignore
    â””â”€â”€ README.md

------------------------------------------------------------------------
## ğŸ‘¥ Autores

| Nome             | Links 									                                                         | E-Mail                                                                      |
| ---------------- | ------------------------------------------------------------------------------- | --------------------------------------------------------------------------- |
| Henrique Luan F. | [LinkedIn](https://www.linkedin.com/in/henrique-luan-fritz-70412635a/)          | [Henrique.fritz@sou.unijui.edu.br](mailto:Henrique.fritz@sou.unijui.edu.br) |
| Luan Vitor C. D. | [LinkedIn](https://www.linkedin.com/in/luan-vitor-casali-dallabrida-20a60a342/) | [luanvitorcd@gmail.com](mailto:luanvitorcd@gmail.com) 			                 |
| Lucas P. Sckenal | [LinkedIn](https://www.linkedin.com/in/lucassckenal/)        		               | [lucaspsckenal@gmail.com](mailto:lucaspsckenal@gmail.com) 		               |

------------------------------------------------------------------------

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ sob licenÃ§a **MIT**.
